<template>
    <div class="login">

        <h1>Welcome Back!</h1>
        <p>Please login to your account.</p>

        <div class="login__field">
            <label for="email">Username or E-mail Address</label>
            <input type="text" v-model="loginInfo.email"/>
        </div>

        <div class="login__field">
            <label for="password">Password</label>
            <input :type="passwordFieldType" v-model="loginInfo.password"/>
            <div class="show-password">
                <svg @click="passwordFieldType = 'text'" v-if="passwordFieldType === 'password'" height="100%" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;" version="1.1" viewBox="0 0 128 128" width="100%" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:serif="http://www.serif.com/" xmlns:xlink="http://www.w3.org/1999/xlink"><rect height="128" id="Eye" style="fill:none;" width="128" x="0.151" y="0"/><clipPath id="_clip1"><rect height="128" width="128" x="0.151" y="0"/></clipPath><g clip-path="url(#_clip1)"><path d="M64.444,30.001c24.374,0.19 49.922,9.735 62.228,30.594c0.585,0.992 1.323,2.479 1.323,2.479c0.739,1.976 -1.234,4.17 -2.723,6.404c-12.935,19.399 -37.627,28.522 -61.507,28.522c-24.269,0 -50.062,-9.445 -62.05,-30.589c-0.615,-1.085 -1.379,-2.721 -1.379,-2.721c-0.52,-1.494 0.721,-3.14 1.684,-4.753c11.808,-19.784 36.516,-29.743 61.276,-29.936c0.383,-0.001 0.765,-0.001 1.148,0Zm-1.127,4c-21.626,0.169 -43.742,7.796 -56.05,25.208c-1.057,1.495 -2.034,3.052 -2.869,4.682c0,0 3.081,5.632 6.767,9.721c13.377,14.834 34.636,20.785 54.803,20.365c22.83,-0.475 46.856,-9.45 57.836,-29.797c0,0 0.045,-0.454 -0.168,-0.839c-10.846,-19.342 -35.36,-29.154 -59.213,-29.34c-0.369,-0.001 -0.737,-0.001 -1.106,0Zm1.028,15c9.905,0.188 17.976,11.856 13.325,21.502c-4.061,8.424 -16.853,11.041 -23.866,4.353c-8.237,-7.855 -3.561,-25.595 10.154,-25.855c0.193,-0.001 0.193,-0.001 0.387,0Zm-0.336,4c-7.254,0.137 -13.177,8.704 -9.773,15.764c2.981,6.185 12.358,8.102 17.502,3.196c3.46,-3.298 4.392,-8.958 2.086,-13.2c-1.921,-3.536 -5.498,-5.788 -9.815,-5.76Z" style="fill-rule:nonzero;"/></g></svg>
                <svg @click="passwordFieldType = 'password'" v-if="passwordFieldType === 'text'" height="100%" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;" version="1.1" viewBox="0 0 128 128" width="100%" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:serif="http://www.serif.com/" xmlns:xlink="http://www.w3.org/1999/xlink"><rect height="128" id="Hide" style="fill:none;" width="128" x="0.713" y="0"/><path d="M73.562,52.323l37.737,-37.737c0.413,-0.361 0.623,-0.673 1.754,-0.557c1.441,0.351 2.162,2.138 1.074,3.385l-37.793,37.793c3.084,4.086 4.332,9.591 2.199,14.631c-3.089,7.296 -12.586,11.11 -19.874,7.888c-1.086,-0.48 -2.092,-1.101 -3.008,-1.836l-37.524,37.524c-0.91,0.794 -1.353,0.704 -2.019,0.492c-1.291,-0.409 -1.774,-2.214 -0.809,-3.32l37.601,-37.601c-3.203,-4.425 -4.145,-10.583 -1.626,-15.651c2.519,-5.067 7.563,-8.372 13.634,-8.333c3.191,0.062 6.2,1.321 8.654,3.322Zm23.876,-15.376c1.054,0.208 1.1,0.376 1.571,0.573c12.276,5.169 24.115,13.554 29.537,25.529c0,0 0.295,1.184 -0.415,2.565c-11.251,21.891 -39.324,32.584 -64.921,32.382c-6.675,-0.053 -13.382,-0.554 -19.893,-1.983c0,0 -1.814,-0.365 -2.095,-1.658c-0.325,-1.493 0.781,-2.726 3.243,-2.186c28.156,6.04 60.74,-0.832 77.094,-23.545c1.084,-1.505 2.089,-3.072 2.951,-4.715l0.003,-0.008c-5.595,-10.713 -16.525,-18.406 -27.821,-23.01c0,0 -1.443,-0.625 -1.513,-1.848c-0.067,-1.177 0.994,-2.183 2.259,-2.096Zm-32.608,-6.946c7.359,0.039 14.716,0.785 21.882,2.527c0.743,0.181 1.747,0.837 1.824,1.87c0.106,1.442 -0.868,2.466 -3.36,1.876c-28.03,-6.527 -60.437,-0.614 -77.142,22.647c-1.133,1.577 -2.18,3.223 -3.064,4.952c5.815,10.606 15.977,18.335 27.016,23.228c0,0 1.872,1.468 0.834,2.967c-0.711,1.027 -2.163,0.831 -3.465,0.235c-11.78,-5.438 -22.699,-13.757 -28.401,-25.489c0,0 -0.33,-1.198 0.368,-2.592c10.696,-21.352 37.792,-32.269 63.508,-32.221Zm8.947,27.764l-15.163,15.162c1.762,1.287 3.871,2.072 6.099,2.073c7.485,0.002 13.672,-9.144 9.591,-16.387c-0.164,-0.292 -0.34,-0.575 -0.527,-0.848Zm-2.819,-2.839c-1.8,-1.242 -3.988,-1.941 -6.387,-1.925c-5.076,0.096 -9.786,4.018 -10.686,9.051c-0.502,2.808 0.308,5.686 1.934,8.014l15.139,-15.14Z" style="fill-rule:nonzero;"/></svg>
            </div>
        </div>

        <div class="login__field">
            <button @click="login()">Login</button>
        </div>

        <div class="login__help-links">
            <a href="/sign-up">Sign Up</a>
            <a href="/forgot-password">Forgot Your Password?</a>
        </div>
    </div>
</template>

<script>
export default {
    data() {
        return {
            loginInfo: {
				email: null,
				password: null
			},
            passwordFieldType: 'password',

            allData: ''
        };
    },
    methods: {
        login() {
			// this.clearErrors();
			axios
            .post(api.login, this.loginInfo)
            .then(res => {
                    jwtToken.setToken(res.data.token);
                    this.setAuthUser(res.data.user);

                    // Adding window.location here  (this is causing issue in incognito mode,
                    // the session is not set and it redirects to /payout
                    // even if the stripe_connect_id exist)
                    // window.location = (this.$route.query.redirect || "/dashboard");
                })
            .catch(err => {
                this.generalError = err.response.data.error || err.response.data.message;

                if (this.generalError)
                    this.$noty.error(this.generalError);

                if (err.response.data.errors) {
                    this.generalError = null;
                    this.emailError = err.response.data.errors.email && err.response.data.errors.email[0];
                    this.passwordError = err.response.data.errors.password && err.response.data.errors.password[0];
                } else {
                    this.emailError = this.passwordError = null;
                }
            });
		},
    },
};
</script>

<style lang="scss" scoped>
$mainColor: #3FE0D0;

.login {
    max-width: 90%;
    margin-left: auto;
    margin-right: auto;
    margin-top: 20vh;
    max-width: 640px;
    padding-left: 20px;
    padding-right: 20px;
    h1 {
        color: $mainColor;
        font-weight: 600;
        padding: 0;
        padding-top: 20px;
        font-size: 40px;
        margin: 0;
        & span {
            color: #00C2AD;
        }
    }

    p {
        color: #868686;
        padding: 0;
        margin: 0;
        padding-top: 10px;
        padding-bottom: 30px;
    }

    a {
        color: #3FE0D0;
        font-size: 14px;
        text-decoration: underline;

    }

    &__field {
        display: flex;
        flex-direction: column;
        padding-bottom: 20px;
        position: relative;
        & label {
            color: #051C1A;

            font-family: 'Inter', sans-serif;
            font-size: 18px;
            margin-bottom: 5px;
        }
        & input {
            height: 30px;
            width: 100%;
            border: none;
            border-bottom: 1px solid #615b5b;
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            &:focus {
                outline: none;
            }
        }

        & button {
            background-color: $mainColor;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 20px;
            padding: 8px 0;
            transition: 0.2s ease;
            &:focus {
                outline: none;
            }
            &:hover {
                background-color: #33b9ac;
            }
        }
    }

    &__help-links {
        display: flex;
        justify-content: space-between;
        border-top: 1px solid #b8b8b8;
        margin-top: 20px;
        padding-top: 20px;

    }
}

.show-password {
    position: absolute;
    bottom: 24px;
    right: 20px;
    z-index: 100;
    & svg {
        width: 20px;
        height: 20px;
    }
    &:hover {
        cursor: pointer;
    }
}

</style>
